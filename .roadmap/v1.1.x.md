# Bun Server Framework - v1.1.x Roadmap

> ç›®æ ‡ç‰ˆæœ¬ï¼šv1.1.0 - v1.1.x\
> é‡ç‚¹ï¼šè‡ªå®šä¹‰æ³¨è§£å’Œæ‹¦æˆªå™¨æœºåˆ¶ï¼Œæä¾›é€šç”¨ AOP æ”¯æŒ

## ğŸ¯ v1.1.x ç‰ˆæœ¬ç›®æ ‡

v1.1.x ç‰ˆæœ¬ä¸“æ³¨äº**è‡ªå®šä¹‰æ³¨è§£å’Œæ‹¦æˆªå™¨æœºåˆ¶**ï¼Œä¸ºæ¡†æ¶æä¾›é€šç”¨çš„
AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ”¯æŒï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åˆ›å»ºè‡ªå®šä¹‰æ³¨è§£å¹¶ä¸ bun-server
æ¡†æ¶æ— ç¼é›†æˆã€‚

### æ ¸å¿ƒç›®æ ‡

1. **é€šç”¨æ‹¦æˆªå™¨æœºåˆ¶**ï¼šå®ç°å¯æ‰©å±•çš„æ‹¦æˆªå™¨æ³¨å†Œå’Œæ‰§è¡Œæœºåˆ¶
2. **æ‹¦æˆªå™¨é“¾æ”¯æŒ**ï¼šæ”¯æŒå¤šä¸ªæ‹¦æˆªå™¨é“¾å¼è°ƒç”¨
3. **æ‹¦æˆªå™¨åŸºç±»**ï¼šæä¾›æ‹¦æˆªå™¨åŸºç±»ç®€åŒ–å¼€å‘
4. **å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹**ï¼šæä¾›å®Œæ•´çš„è‡ªå®šä¹‰æ³¨è§£å¼€å‘æŒ‡å—

---

## ğŸ“‹ èƒŒæ™¯å’Œè¯„ä¼°

æ ¹æ®
[è‡ªå®šä¹‰æ³¨è§£èƒ½åŠ›è¯„ä¼°æŠ¥å‘Š](../packages/bun-server/CUSTOM_ANNOTATION_EVALUATION.md)ï¼Œbun-server
æ¡†æ¶å·²ç»å…·å¤‡ï¼š

- âœ… **è£…é¥°å™¨/æ³¨è§£åŸºç¡€è®¾æ–½**ï¼šå®Œå…¨æ”¯æŒï¼ˆåŸºäº `reflect-metadata`ï¼‰
- âœ… **ä¾èµ–æ³¨å…¥å®¹å™¨**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **è¯·æ±‚ä¸Šä¸‹æ–‡**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **æ‹¦æˆªå™¨æœºåˆ¶**ï¼šéƒ¨åˆ†æ”¯æŒï¼ˆéœ€è¦æ‰‹åŠ¨é›†æˆï¼‰
- âœ… **æ¨¡å—åŒ–æ‰©å±•**ï¼šå®Œå…¨æ”¯æŒ

**å½“å‰é™åˆ¶**ï¼š

1. **æ‹¦æˆªå™¨é›†æˆéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ ControllerRegistry**
   - å½“å‰ `TransactionInterceptor` çš„é›†æˆæ˜¯ç¡¬ç¼–ç çš„
   - éœ€è¦æ‰©å±• `ControllerRegistry` ä»¥æ”¯æŒé€šç”¨æ‹¦æˆªå™¨æœºåˆ¶

2. **æ‹¦æˆªå™¨é“¾ä¸æ”¯æŒ**
   - å½“å‰åªæ”¯æŒå•ä¸ªæ‹¦æˆªå™¨
   - éœ€è¦å®ç°æ‹¦æˆªå™¨é“¾æœºåˆ¶ä»¥æ”¯æŒå¤šä¸ªæ‹¦æˆªå™¨

3. **AOP åˆ‡é¢ç‚¹æœ‰é™**
   - å½“å‰ä¸»è¦æ”¯æŒæ–¹æ³•çº§åˆ«çš„æ‹¦æˆª
   - ä¸æ”¯æŒå±æ€§çº§åˆ«çš„æ‹¦æˆª

---

## ğŸš€ v1.1.0 Roadmap

### Phase 1: é€šç”¨æ‹¦æˆªå™¨æœºåˆ¶ ğŸ”´ é«˜ä¼˜å…ˆçº§

**ç›®æ ‡**ï¼šå®ç°å¯æ‰©å±•çš„æ‹¦æˆªå™¨æ³¨å†Œå’Œæ‰§è¡Œæœºåˆ¶ï¼Œæ”¯æŒè‡ªå®šä¹‰æ³¨è§£ä¸æ¡†æ¶æ— ç¼é›†æˆ

#### 1.1 æ‹¦æˆªå™¨æ¥å£å®šä¹‰

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/interceptor/`

- [ ] **å®šä¹‰æ‹¦æˆªå™¨æ¥å£**ï¼ˆ`types.ts`ï¼‰
  - [ ] `Interceptor` æ¥å£å®šä¹‰
    ```typescript
    export interface Interceptor {
      execute<T>(
        target: unknown,
        propertyKey: string | symbol,
        originalMethod: (...args: unknown[]) => T | Promise<T>,
        args: unknown[],
        container: Container,
        context?: Context,
      ): Promise<T>;
    }
    ```
  - [ ] `InterceptorMetadata` ç±»å‹å®šä¹‰
    ```typescript
    export interface InterceptorMetadata {
      metadataKey: symbol;
      interceptor: Interceptor;
      priority?: number; // æ‹¦æˆªå™¨æ‰§è¡Œä¼˜å…ˆçº§
    }
    ```
  - [ ] `INTERCEPTOR_REGISTRY_TOKEN` Symbol token

- [ ] **å®šä¹‰æ‹¦æˆªå™¨æ³¨å†Œè¡¨æ¥å£**ï¼ˆ`interceptor-registry.ts`ï¼‰
  - [ ] `InterceptorRegistry` æ¥å£å®šä¹‰
    ```typescript
    export interface InterceptorRegistry {
      /**
       * æ³¨å†Œæ‹¦æˆªå™¨
       * @param metadataKey - å…ƒæ•°æ®é”®ï¼ˆç”¨äºåŒ¹é…è£…é¥°å™¨ï¼‰
       * @param interceptor - æ‹¦æˆªå™¨å®ä¾‹
       * @param priority - ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰
       */
      register(
        metadataKey: symbol,
        interceptor: Interceptor,
        priority?: number,
      ): void;

      /**
       * è·å–æ‹¦æˆªå™¨åˆ—è¡¨ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
       * @param metadataKey - å…ƒæ•°æ®é”®
       * @returns æ‹¦æˆªå™¨åˆ—è¡¨
       */
      getInterceptors(metadataKey: symbol): Interceptor[];

      /**
       * æ£€æŸ¥æ˜¯å¦æœ‰æ‹¦æˆªå™¨
       * @param metadataKey - å…ƒæ•°æ®é”®
       * @returns æ˜¯å¦æœ‰æ‹¦æˆªå™¨
       */
      hasInterceptor(metadataKey: symbol): boolean;

      /**
       * æ¸…é™¤æ‰€æœ‰æ‹¦æˆªå™¨
       */
      clear(): void;
    }
    ```

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.0

#### 1.2 æ‹¦æˆªå™¨æ³¨å†Œè¡¨å®ç°

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/interceptor/interceptor-registry.ts`

- [ ] **å®ç° InterceptorRegistry ç±»**
  - [ ] æ‹¦æˆªå™¨å­˜å‚¨ï¼ˆä½¿ç”¨ `Map<symbol, InterceptorMetadata[]>`ï¼‰
  - [ ] æ‹¦æˆªå™¨æ³¨å†Œé€»è¾‘
  - [ ] æ‹¦æˆªå™¨æŸ¥è¯¢é€»è¾‘ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
  - [ ] æ‹¦æˆªå™¨æ¸…é™¤é€»è¾‘

- [ ] **é›†æˆåˆ° DI å®¹å™¨**
  - [ ] æ³¨å†Œ `InterceptorRegistry` ä¸ºå•ä¾‹
  - [ ] æä¾› `INTERCEPTOR_REGISTRY_TOKEN` token
  - [ ] æ”¯æŒé€šè¿‡ `@Inject()` æ³¨å…¥

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.0

#### 1.3 ControllerRegistry é›†æˆ

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/controller/controller.ts`

- [ ] **æ‰©å±• ControllerRegistry æ”¯æŒæ‹¦æˆªå™¨**
  - [ ] æ³¨å…¥ `InterceptorRegistry`ï¼ˆé€šè¿‡æ„é€ å‡½æ•°æˆ–å®¹å™¨ï¼‰
  - [ ] åœ¨è·¯ç”±å¤„ç†å™¨åˆ›å»ºæ—¶æ£€æŸ¥æ‰€æœ‰æ³¨å†Œçš„æ‹¦æˆªå™¨
  - [ ] æŒ‰ä¼˜å…ˆçº§é¡ºåºæ‰§è¡Œæ‹¦æˆªå™¨é“¾
  - [ ] ç§»é™¤ç¡¬ç¼–ç çš„ `TransactionInterceptor` é€»è¾‘

- [ ] **æ‹¦æˆªå™¨æ‰§è¡Œé€»è¾‘**
  ```typescript
  // ä¼ªä»£ç ç¤ºä¾‹
  const handler = async (context: Context): Promise<Response> => {
    const controllerInstance = container.resolve(controllerClass);
    const method = controllerInstance[propertyKey];

    // è·å–æ‰€æœ‰æ‹¦æˆªå™¨ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
    const interceptors = interceptorRegistry.getAllInterceptors(
      prototype,
      propertyKey,
    );

    // æ„å»ºæ‹¦æˆªå™¨é“¾
    let result: unknown;
    if (interceptors.length > 0) {
      // æ‰§è¡Œæ‹¦æˆªå™¨é“¾
      result = await executeInterceptorChain(
        interceptors,
        prototype,
        propertyKey,
        method,
        params,
        container,
        context,
      );
    } else {
      // æ²¡æœ‰æ‹¦æˆªå™¨ï¼Œç›´æ¥æ‰§è¡Œ
      result = method.apply(controllerInstance, params);
    }

    return context.createResponse(result);
  };
  ```

- [ ] **ä¿æŒå‘åå…¼å®¹**
  - [ ] `TransactionInterceptor` é€šè¿‡æ³¨å†Œè¡¨æ³¨å†Œï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç 
  - [ ] ç°æœ‰åŠŸèƒ½ä¸å—å½±å“

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.0

---

### Phase 2: æ‹¦æˆªå™¨é“¾æ”¯æŒ ğŸ”´ é«˜ä¼˜å…ˆçº§

**ç›®æ ‡**ï¼šæ”¯æŒå¤šä¸ªæ‹¦æˆªå™¨é“¾å¼è°ƒç”¨ï¼Œå®ç°å¤æ‚çš„ AOP åœºæ™¯

#### 2.1 æ‹¦æˆªå™¨é“¾æ‰§è¡Œå™¨

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/interceptor/interceptor-chain.ts`

- [ ] **å®ç°æ‹¦æˆªå™¨é“¾æ‰§è¡Œå™¨**
  - [ ] `InterceptorChain` ç±»å®šä¹‰
  - [ ] é“¾å¼æ‰§è¡Œé€»è¾‘ï¼ˆæŒ‰ä¼˜å…ˆçº§é¡ºåºï¼‰
  - [ ] æ”¯æŒå‰ç½®å¤„ç†ã€åç½®å¤„ç†ã€é”™è¯¯å¤„ç†
  - [ ] æ”¯æŒä¸­æ–­é“¾å¼æ‰§è¡Œï¼ˆæŠ›å‡ºå¼‚å¸¸ï¼‰

- [ ] **æ‹¦æˆªå™¨é“¾æ‰§è¡Œæ¨¡å¼**
  ```typescript
  // ä¼ªä»£ç ç¤ºä¾‹
  async function executeInterceptorChain(
    interceptors: Interceptor[],
    target: unknown,
    propertyKey: string | symbol,
    originalMethod: Function,
    args: unknown[],
    container: Container,
    context?: Context,
  ): Promise<unknown> {
    // æŒ‰ä¼˜å…ˆçº§æ’åº
    const sortedInterceptors = interceptors.sort((a, b) =>
      a.priority - b.priority
    );

    // æ„å»ºæ‰§è¡Œé“¾
    let index = 0;
    const next = async (): Promise<unknown> => {
      if (index >= sortedInterceptors.length) {
        // æ‰€æœ‰æ‹¦æˆªå™¨æ‰§è¡Œå®Œæ¯•ï¼Œæ‰§è¡ŒåŸæ–¹æ³•
        return await Promise.resolve(originalMethod.apply(target, args));
      }

      const interceptor = sortedInterceptors[index++];
      return await interceptor.execute(
        target,
        propertyKey,
        async (...args) => await next(), // ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨æˆ–åŸæ–¹æ³•
        args,
        container,
        context,
      );
    };

    return await next();
  }
  ```

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.0

#### 2.2 å¤šæ‹¦æˆªå™¨å…ƒæ•°æ®æ”¯æŒ

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/interceptor/metadata.ts`

- [ ] **æ”¯æŒæ–¹æ³•ä¸Šå¤šä¸ªè£…é¥°å™¨**
  - [ ] æ‰«ææ–¹æ³•ä¸Šçš„æ‰€æœ‰å…ƒæ•°æ®é”®
  - [ ] æ”¶é›†æ‰€æœ‰åŒ¹é…çš„æ‹¦æˆªå™¨
  - [ ] åˆå¹¶å¹¶æ’åºæ‹¦æˆªå™¨åˆ—è¡¨

- [ ] **å…ƒæ•°æ®æ‰«æå·¥å…·**
  ```typescript
  /**
   * æ‰«ææ–¹æ³•ä¸Šçš„æ‰€æœ‰æ‹¦æˆªå™¨å…ƒæ•°æ®
   */
  export function scanInterceptorMetadata(
    target: unknown,
    propertyKey: string | symbol,
    registry: InterceptorRegistry,
  ): Interceptor[] {
    const interceptors: Interceptor[] = [];

    // æ‰«ææ‰€æœ‰å·²æ³¨å†Œçš„å…ƒæ•°æ®é”®
    for (const [metadataKey] of registry.getAllMetadataKeys()) {
      const metadata = Reflect.getMetadata(metadataKey, target, propertyKey);
      if (metadata) {
        const matchedInterceptors = registry.getInterceptors(metadataKey);
        interceptors.push(...matchedInterceptors);
      }
    }

    // æŒ‰ä¼˜å…ˆçº§æ’åº
    return interceptors.sort((a, b) => (a.priority ?? 0) - (b.priority ?? 0));
  }
  ```

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.0

---

### Phase 3: æ‹¦æˆªå™¨åŸºç±» ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**ç›®æ ‡**ï¼šæä¾›æ‹¦æˆªå™¨åŸºç±»ç®€åŒ–è‡ªå®šä¹‰æ‹¦æˆªå™¨å¼€å‘

#### 3.1 æ‹¦æˆªå™¨åŸºç±»å®ç°

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/interceptor/base-interceptor.ts`

- [ ] **å®ç° BaseInterceptor æŠ½è±¡ç±»**
  ```typescript
  export abstract class BaseInterceptor implements Interceptor {
    /**
     * æ‰§è¡Œæ‹¦æˆªå™¨é€»è¾‘
     */
    public abstract execute<T>(
      target: unknown,
      propertyKey: string | symbol,
      originalMethod: (...args: unknown[]) => T | Promise<T>,
      args: unknown[],
      container: Container,
      context?: Context,
    ): Promise<T>;

    /**
     * å‰ç½®å¤„ç†ï¼ˆå¯é€‰ï¼‰
     */
    protected async before(
      target: unknown,
      propertyKey: string | symbol,
      args: unknown[],
      container: Container,
      context?: Context,
    ): Promise<void> {
      // é»˜è®¤ç©ºå®ç°ï¼Œå­ç±»å¯è¦†ç›–
    }

    /**
     * åç½®å¤„ç†ï¼ˆå¯é€‰ï¼‰
     */
    protected async after(
      target: unknown,
      propertyKey: string | symbol,
      result: unknown,
      container: Container,
      context?: Context,
    ): Promise<unknown> {
      // é»˜è®¤è¿”å›åŸç»“æœï¼Œå­ç±»å¯è¦†ç›–
      return result;
    }

    /**
     * é”™è¯¯å¤„ç†ï¼ˆå¯é€‰ï¼‰
     */
    protected async onError(
      target: unknown,
      propertyKey: string | symbol,
      error: unknown,
      container: Container,
      context?: Context,
    ): Promise<never> {
      // é»˜è®¤é‡æ–°æŠ›å‡ºé”™è¯¯ï¼Œå­ç±»å¯è¦†ç›–
      throw error;
    }
  }
  ```

- [ ] **æä¾›ä¾¿æ·æ–¹æ³•**
  - [ ] `getMetadata()` - è·å–å…ƒæ•°æ®
  - [ ] `resolveService()` - ä»å®¹å™¨è§£ææœåŠ¡
  - [ ] `getContextValue()` - ä»ä¸Šä¸‹æ–‡è·å–å€¼

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ ä¸­\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.1

#### 3.2 å¸¸ç”¨æ‹¦æˆªå™¨ç¤ºä¾‹

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/interceptor/builtin/`

- [ ] **ç¼“å­˜æ‹¦æˆªå™¨ç¤ºä¾‹**ï¼ˆ`cache-interceptor.ts`ï¼‰
  - [ ] å±•ç¤ºå¦‚ä½•ä½¿ç”¨ `BaseInterceptor`
  - [ ] å®ç°ç¼“å­˜é€»è¾‘
  - [ ] æä¾›å®Œæ•´ç¤ºä¾‹ä»£ç 

- [ ] **æƒé™æ‹¦æˆªå™¨ç¤ºä¾‹**ï¼ˆ`permission-interceptor.ts`ï¼‰
  - [ ] å±•ç¤ºå¦‚ä½•è®¿é—®å®¹å™¨å’Œä¸Šä¸‹æ–‡
  - [ ] å®ç°æƒé™æ£€æŸ¥é€»è¾‘
  - [ ] æä¾›å®Œæ•´ç¤ºä¾‹ä»£ç 

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ ä¸­\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.1

---

### Phase 4: TransactionInterceptor é‡æ„ ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**ç›®æ ‡**ï¼šå°†ç°æœ‰çš„ `TransactionInterceptor` é‡æ„ä¸ºä½¿ç”¨æ–°çš„æ‹¦æˆªå™¨æœºåˆ¶

#### 4.1 TransactionInterceptor é‡æ„

**å®ç°ä½ç½®**ï¼š`packages/bun-server/src/database/orm/transaction-interceptor.ts`

- [ ] **é‡æ„ TransactionInterceptor**
  - [ ] å®ç° `Interceptor` æ¥å£æˆ–ç»§æ‰¿ `BaseInterceptor`
  - [ ] ç§»é™¤ç¡¬ç¼–ç çš„é›†æˆé€»è¾‘
  - [ ] é€šè¿‡ `InterceptorRegistry` æ³¨å†Œ

- [ ] **æ³¨å†Œ TransactionInterceptor**
  - [ ] åœ¨ `DatabaseModule` ä¸­æ³¨å†Œæ‹¦æˆªå™¨
  - [ ] ä½¿ç”¨ `TRANSACTION_METADATA_KEY` ä½œä¸ºå…ƒæ•°æ®é”®
  - [ ] è®¾ç½®åˆé€‚çš„ä¼˜å…ˆçº§

- [ ] **ç§»é™¤ ControllerRegistry ä¸­çš„ç¡¬ç¼–ç **
  - [ ] ç§»é™¤ `TransactionInterceptor` çš„ç¡¬ç¼–ç è°ƒç”¨
  - [ ] ç¡®ä¿é€šè¿‡æ‹¦æˆªå™¨æœºåˆ¶æ‰§è¡Œ

**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ ä¸­\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.1

---

### Phase 5: æ–‡æ¡£å’Œç¤ºä¾‹ ğŸŸ¢ ä½ä¼˜å…ˆçº§

**ç›®æ ‡**ï¼šæä¾›å®Œæ•´çš„è‡ªå®šä¹‰æ³¨è§£å¼€å‘æŒ‡å—å’Œç¤ºä¾‹

#### 5.1 å¼€å‘æ–‡æ¡£

- [ ] **è‡ªå®šä¹‰æ³¨è§£å¼€å‘æŒ‡å—**ï¼ˆ`docs/custom-decorators.md`ï¼‰
  - [ ] è£…é¥°å™¨å¼€å‘è§„èŒƒ
  - [ ] æ‹¦æˆªå™¨å¼€å‘è§„èŒƒ
  - [ ] å…ƒæ•°æ®ç³»ç»Ÿä½¿ç”¨æŒ‡å—
  - [ ] å®¹å™¨å’Œä¸Šä¸‹æ–‡è®¿é—®æŒ‡å—

- [ ] **API æ–‡æ¡£æ›´æ–°**
  - [ ] `Interceptor` æ¥å£æ–‡æ¡£
  - [ ] `InterceptorRegistry` æ¥å£æ–‡æ¡£
  - [ ] `BaseInterceptor` ç±»æ–‡æ¡£
  - [ ] æ‹¦æˆªå™¨é“¾æ‰§è¡Œæœºåˆ¶æ–‡æ¡£

**ä¼˜å…ˆçº§**ï¼šğŸŸ¢ ä½\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.2

#### 5.2 ç¤ºä¾‹ä»£ç 

- [ ] **åŸºç¡€ç¤ºä¾‹**ï¼ˆ`examples/custom-decorator-app.ts`ï¼‰
  - [ ] åˆ›å»ºè‡ªå®šä¹‰è£…é¥°å™¨
  - [ ] å®ç°æ‹¦æˆªå™¨
  - [ ] æ³¨å†Œå’Œä½¿ç”¨

- [ ] **é«˜çº§ç¤ºä¾‹**ï¼ˆ`examples/advanced-decorator-app.ts`ï¼‰
  - [ ] å¤šä¸ªæ‹¦æˆªå™¨é“¾å¼è°ƒç”¨
  - [ ] è®¿é—®å®¹å™¨å’Œä¸Šä¸‹æ–‡
  - [ ] é”™è¯¯å¤„ç†

- [ ] **å®é™…åº”ç”¨ç¤ºä¾‹**
  - [ ] ç¼“å­˜è£…é¥°å™¨ç¤ºä¾‹
  - [ ] æƒé™è£…é¥°å™¨ç¤ºä¾‹
  - [ ] æ—¥å¿—è£…é¥°å™¨ç¤ºä¾‹

**ä¼˜å…ˆçº§**ï¼šğŸŸ¢ ä½\
**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šv1.1.2

---

## ğŸ“¦ æ¨¡å—ç»“æ„è§„åˆ’

### æ–°å¢æ¨¡å—ç»“æ„

```
packages/bun-server/src/
â”œâ”€â”€ interceptor/
â”‚   â”œâ”€â”€ types.ts                    # æ‹¦æˆªå™¨æ¥å£å’Œç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ interceptor-registry.ts     # æ‹¦æˆªå™¨æ³¨å†Œè¡¨å®ç°
â”‚   â”œâ”€â”€ interceptor-chain.ts        # æ‹¦æˆªå™¨é“¾æ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ metadata.ts                 # å…ƒæ•°æ®æ‰«æå·¥å…·
â”‚   â”œâ”€â”€ base-interceptor.ts         # æ‹¦æˆªå™¨åŸºç±»
â”‚   â”œâ”€â”€ builtin/                    # å†…ç½®æ‹¦æˆªå™¨ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ cache-interceptor.ts
â”‚   â”‚   â””â”€â”€ permission-interceptor.ts
â”‚   â””â”€â”€ index.ts                    # æ¨¡å—å¯¼å‡º
```

### é›†æˆç‚¹

1. **ControllerRegistry**ï¼šåœ¨è·¯ç”±å¤„ç†å™¨åˆ›å»ºæ—¶é›†æˆæ‹¦æˆªå™¨æœºåˆ¶
2. **DI å®¹å™¨**ï¼šæ³¨å†Œ `InterceptorRegistry` ä¸ºå•ä¾‹æœåŠ¡
3. **DatabaseModule**ï¼šæ³¨å†Œ `TransactionInterceptor` åˆ°æ‹¦æˆªå™¨æ³¨å†Œè¡¨

---

## ğŸ¯ v1.1.0 å‘å¸ƒæ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§

- [ ] **æ‹¦æˆªå™¨æœºåˆ¶æ ¸å¿ƒåŠŸèƒ½**
  - [ ] `Interceptor` æ¥å£å®šä¹‰å®Œæˆ
  - [ ] `InterceptorRegistry` å®ç°å®Œæˆ
  - [ ] `ControllerRegistry` é›†æˆå®Œæˆ
  - [ ] æ‹¦æˆªå™¨é“¾æ‰§è¡Œæœºåˆ¶å®Œæˆ

- [ ] **å‘åå…¼å®¹**
  - [ ] `TransactionInterceptor` é‡æ„å®Œæˆ
  - [ ] ç°æœ‰åŠŸèƒ½ä¸å—å½±å“
  - [ ] ç°æœ‰æµ‹è¯•å…¨éƒ¨é€šè¿‡

### ç¨³å®šæ€§

- [ ] **å•å…ƒæµ‹è¯•**
  - [ ] `InterceptorRegistry` å•å…ƒæµ‹è¯•
  - [ ] `InterceptorChain` å•å…ƒæµ‹è¯•
  - [ ] `BaseInterceptor` å•å…ƒæµ‹è¯•
  - [ ] é›†æˆæµ‹è¯•ï¼ˆå¤šä¸ªæ‹¦æˆªå™¨é“¾å¼è°ƒç”¨ï¼‰

- [ ] **æ€§èƒ½æµ‹è¯•**
  - [ ] æ‹¦æˆªå™¨æ‰§è¡Œæ€§èƒ½æµ‹è¯•
  - [ ] æ‹¦æˆªå™¨é“¾æ‰§è¡Œæ€§èƒ½æµ‹è¯•
  - [ ] ä¸ç›´æ¥æ–¹æ³•è°ƒç”¨æ€§èƒ½å¯¹æ¯”

- [ ] **æ— å·²çŸ¥ä¸¥é‡ Bug**

### æ–‡æ¡£

- [ ] **å¼€å‘æ–‡æ¡£**
  - [ ] è‡ªå®šä¹‰æ³¨è§£å¼€å‘æŒ‡å—
  - [ ] æ‹¦æˆªå™¨å¼€å‘æŒ‡å—
  - [ ] API æ–‡æ¡£æ›´æ–°

- [ ] **ç¤ºä¾‹ä»£ç **
  - [ ] åŸºç¡€ç¤ºä¾‹
  - [ ] é«˜çº§ç¤ºä¾‹
  - [ ] å®é™…åº”ç”¨ç¤ºä¾‹

---

## ğŸ“ å®ç°æ³¨æ„äº‹é¡¹

### 1. å‘åå…¼å®¹æ€§

- **é‡è¦**ï¼šç¡®ä¿ç°æœ‰åŠŸèƒ½ä¸å—å½±å“
- `TransactionInterceptor` é‡æ„ååŠŸèƒ½ä¿æŒä¸€è‡´
- ç°æœ‰æµ‹è¯•å…¨éƒ¨é€šè¿‡

### 2. æ€§èƒ½è€ƒè™‘

- **æ‹¦æˆªå™¨æ‰§è¡Œå¼€é”€**ï¼šæœ€å°åŒ–æ‹¦æˆªå™¨æ‰§è¡Œå¼€é”€
- **æ‹¦æˆªå™¨é“¾ä¼˜åŒ–**ï¼šä¼˜åŒ–æ‹¦æˆªå™¨é“¾æ‰§è¡Œé€»è¾‘
- **ç¼“å­˜æœºåˆ¶**ï¼šè€ƒè™‘ç¼“å­˜æ‹¦æˆªå™¨æŸ¥æ‰¾ç»“æœ

### 3. é”™è¯¯å¤„ç†

- **æ‹¦æˆªå™¨é”™è¯¯**ï¼šå®šä¹‰ç»Ÿä¸€çš„é”™è¯¯ç±»å‹
- **é“¾å¼æ‰§è¡Œé”™è¯¯**ï¼šæ”¯æŒé”™è¯¯ä¼ æ’­å’Œä¸­æ–­
- **é”™è¯¯æ¢å¤**ï¼šæä¾›é”™è¯¯æ¢å¤æœºåˆ¶

### 4. æ‰©å±•æ€§

- **æ¥å£è®¾è®¡**ï¼šæ¥å£è®¾è®¡è¦è€ƒè™‘æœªæ¥æ‰©å±•
- **æ’ä»¶æœºåˆ¶**ï¼šæ”¯æŒé€šè¿‡æ’ä»¶æ³¨å†Œæ‹¦æˆªå™¨
- **åŠ¨æ€æ³¨å†Œ**ï¼šæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€æ³¨å†Œæ‹¦æˆªå™¨

### 5. ç±»å‹å®‰å…¨

- **TypeScript æ”¯æŒ**ï¼šå……åˆ†åˆ©ç”¨ TypeScript ç±»å‹ç³»ç»Ÿ
- **æ³›å‹æ”¯æŒ**ï¼šæ”¯æŒæ³›å‹æ‹¦æˆªå™¨
- **ç±»å‹æ¨æ–­**ï¼šæä¾›è‰¯å¥½çš„ç±»å‹æ¨æ–­

---

## ğŸ”— ç›¸å…³èµ„æº

- [è‡ªå®šä¹‰æ³¨è§£èƒ½åŠ›è¯„ä¼°æŠ¥å‘Š](../packages/bun-server/CUSTOM_ANNOTATION_EVALUATION.md)
- [v1.2.x Roadmap](./v1.2.x.md) - å¾®æœåŠ¡æ¶æ„æ”¯æŒï¼ˆå·²æ»åï¼‰
- [v1.x.x æ±‡æ€»æ¸…å•](./v1.x.x.md)
- [æ‰©å±•ç³»ç»Ÿæ–‡æ¡£](../docs/extensions.md)
